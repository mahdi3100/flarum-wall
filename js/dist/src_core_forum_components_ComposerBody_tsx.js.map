{"version":3,"file":"src_core_forum_components_ComposerBody_tsx.js","mappings":"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","sources":["webpack://@leo/flarum-wall/./src/core/common/components/ConfirmDocumentUnload.js","webpack://@leo/flarum-wall/./src/core/common/components/TextEditor.js","webpack://@leo/flarum-wall/./src/core/common/utils/BasicEditorDriver.ts","webpack://@leo/flarum-wall/./src/core/common/utils/insertText.ts","webpack://@leo/flarum-wall/./src/core/forum/components/ComposerBody.tsx"],"sourcesContent":["import Component from '../Component';\n\n/**\n * The `ConfirmDocumentUnload` component can be used to register a global\n * event handler that prevents closing the browser window/tab based on the\n * return value of a given callback prop.\n *\n * ### Attrs\n *\n * - `when` - a callback returning true when the browser should prompt for\n *            confirmation before closing the window/tab\n */\nexport default class ConfirmDocumentUnload extends Component {\n  handler() {\n    return this.attrs.when() || undefined;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.boundHandler = this.handler.bind(this);\n    $(window).on('beforeunload', this.boundHandler);\n  }\n\n  onremove(vnode) {\n    super.onremove(vnode);\n\n    $(window).off('beforeunload', this.boundHandler);\n  }\n\n  view(vnode) {\n    return <>{vnode.children}</>;\n  }\n}\n","import app from '../../common/app';\n\nimport Component from '../Component';\nimport ItemList from '../utils/ItemList';\nimport listItems from '../helpers/listItems';\nimport Button from './Button';\n\nimport BasicEditorDriver from '../utils/BasicEditorDriver';\nimport Tooltip from './Tooltip';\nimport LoadingIndicator from './LoadingIndicator';\n\n/**\n * The `TextEditor` component displays a textarea with controls, including a\n * submit button.\n *\n * ### Attrs\n *\n * - `composer`\n * - `submitLabel`\n * - `value`\n * - `placeholder`\n * - `disabled`\n * - `preview`\n */\nexport default class TextEditor extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    /**\n     * The value of the editor.\n     *\n     * @type {String}\n     */\n    this.value = this.attrs.value || '';\n\n    /**\n     * Whether the editor is disabled.\n     */\n    this.disabled = !!this.attrs.disabled;\n\n    /**\n     * Whether the editor is loading.\n     */\n    this.loading = true;\n\n    /**\n     * Async operations to complete before the editor is ready.\n     */\n    this._loaders = [];\n  }\n\n  view() {\n    return (\n      <div className=\"TextEditor\">\n        {this.loading ? (\n          <LoadingIndicator />\n        ) : (\n          <>\n            <div className=\"TextEditor-editorContainer\"></div>\n\n            <ul className=\"TextEditor-controls Composer-footer\">\n              {listItems(this.controlItems().toArray())}\n              <li className=\"TextEditor-toolbar\">{this.toolbarItems().toArray()}</li>\n            </ul>\n          </>\n        )}\n      </div>\n    );\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this._load().then(() => {\n      setTimeout(this.onbuild.bind(this), 50);\n    });\n  }\n\n  onbuild() {\n    this.attrs.composer.editor = this.buildEditor(this.$('.TextEditor-editorContainer')[0]);\n  }\n\n  onupdate(vnode) {\n    super.onupdate(vnode);\n\n    const newDisabled = !!this.attrs.disabled;\n\n    if (this.disabled !== newDisabled) {\n      this.disabled = newDisabled;\n      this.attrs.composer.editor.disabled(newDisabled);\n    }\n  }\n\n  _load() {\n    return Promise.all(this._loaders.map((loader) => loader())).then(() => {\n      this.loading = false;\n      m.redraw();\n    });\n  }\n\n  buildEditorParams() {\n    return {\n      classNames: ['FormControl', 'Composer-flexible', 'TextEditor-editor'],\n      disabled: this.disabled,\n      placeholder: this.attrs.placeholder || '',\n      value: this.value,\n      oninput: this.oninput.bind(this),\n      inputListeners: [],\n      onsubmit: () => {\n        this.onsubmit();\n        m.redraw();\n      },\n    };\n  }\n\n  buildEditor(dom) {\n    return new BasicEditorDriver(dom, this.buildEditorParams());\n  }\n\n  /**\n   * Build an item list for the text editor controls.\n   *\n   * @return {ItemList<import('mithril').Children>}\n   */\n  controlItems() {\n    const items = new ItemList();\n\n    items.add(\n      'submit',\n      <Button icon=\"fas fa-paper-plane\" className=\"Button Button--primary\" itemClassName=\"App-primaryControl\" onclick={this.onsubmit.bind(this)}>\n        {this.attrs.submitLabel}\n      </Button>\n    );\n\n    if (this.attrs.preview) {\n      items.add(\n        'preview',\n        <Tooltip text={app.translator.trans('core.forum.composer.preview_tooltip')}>\n          <Button icon=\"far fa-eye\" className=\"Button Button--icon\" onclick={this.attrs.preview} />\n        </Tooltip>\n      );\n    }\n\n    return items;\n  }\n\n  /**\n   * Build an item list for the toolbar controls.\n   *\n   * @return {ItemList<import('mithril').Children>}\n   */\n  toolbarItems() {\n    return new ItemList();\n  }\n\n  /**\n   * Handle input into the textarea.\n   *\n   * @param {string} value\n   */\n  oninput(value) {\n    this.value = value;\n\n    this.attrs.onchange(this.value);\n  }\n\n  /**\n   * Handle the submit button being clicked.\n   */\n  onsubmit() {\n    this.attrs.onsubmit(this.value);\n  }\n}\n","import getCaretCoordinates from 'textarea-caret';\nimport insertText from './insertText';\nimport ItemList from './ItemList';\nimport type EditorDriverInterface from './EditorDriverInterface';\nimport { type EditorDriverParams } from './EditorDriverInterface';\n\nexport default class BasicEditorDriver implements EditorDriverInterface {\n  el: HTMLTextAreaElement;\n\n  constructor(dom: HTMLElement, params: EditorDriverParams) {\n    this.el = document.createElement('textarea');\n\n    this.build(dom, params);\n  }\n\n  protected build(dom: HTMLElement, params: EditorDriverParams) {\n    this.el.className = params.classNames.join(' ');\n    this.el.disabled = params.disabled;\n    this.el.placeholder = params.placeholder;\n    this.el.value = params.value;\n\n    const callInputListeners = (e: Event) => {\n      params.inputListeners.forEach((listener) => {\n        listener();\n      });\n\n      e.redraw = false;\n    };\n\n    this.el.oninput = (e) => {\n      params.oninput(this.el.value);\n      callInputListeners(e);\n    };\n\n    this.el.onclick = callInputListeners;\n    this.el.onkeyup = callInputListeners;\n\n    this.el.addEventListener('keydown', (e) => {\n      this.keyHandlers(params)\n        .toArray()\n        .forEach((handler) => handler(e));\n    });\n\n    dom.append(this.el);\n  }\n\n  protected keyHandlers(params: EditorDriverParams) {\n    const items = new ItemList<(e: KeyboardEvent) => void>();\n\n    items.add('submit', function (e: KeyboardEvent) {\n      if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') {\n        params.onsubmit();\n      }\n    });\n\n    return items;\n  }\n\n  moveCursorTo(position: number) {\n    this.setSelectionRange(position, position);\n  }\n\n  getSelectionRange(): Array<number> {\n    return [this.el.selectionStart, this.el.selectionEnd];\n  }\n\n  getLastNChars(n: number): string {\n    const value = this.el.value;\n\n    return value.slice(Math.max(0, this.el.selectionStart - n), this.el.selectionStart);\n  }\n\n  insertAtCursor(text: string) {\n    this.insertAt(this.el.selectionStart, text);\n  }\n\n  insertAt(pos: number, text: string) {\n    this.insertBetween(pos, pos, text);\n  }\n\n  insertBetween(selectionStart: number, selectionEnd: number, text: string) {\n    this.setSelectionRange(selectionStart, selectionEnd);\n\n    const cursorPos = selectionStart + text.length;\n    insertText(this.el, { text, selectionStart: cursorPos, selectionEnd: cursorPos });\n  }\n\n  replaceBeforeCursor(start: number, text: string) {\n    this.insertBetween(start, this.el.selectionStart, text);\n  }\n\n  protected setSelectionRange(start: number, end: number) {\n    this.el.setSelectionRange(start, end);\n    this.focus();\n  }\n\n  getCaretCoordinates(position: number) {\n    const relCoords = getCaretCoordinates(this.el, position);\n\n    return {\n      top: relCoords.top - this.el.scrollTop,\n      left: relCoords.left,\n    };\n  }\n\n  // DOM Interactions\n\n  /**\n   * Set the disabled status of the editor.\n   */\n  disabled(disabled: boolean) {\n    this.el.disabled = disabled;\n  }\n\n  /**\n   * Focus on the editor.\n   */\n  focus() {\n    this.el.focus();\n  }\n\n  /**\n   * Destroy the editor\n   */\n  destroy() {\n    this.el.remove();\n  }\n}\n","/*\n * Original Copyright GitHub, Inc. Licensed under the MIT License.\n * See license text at https://github.com/github/markdown-toolbar-element/blob/master/LICENSE.\n */\n\nexport interface SelectionRange {\n  text: string;\n  selectionStart: number | undefined;\n  selectionEnd: number | undefined;\n}\n\nlet canInsertText: boolean | null = null;\n\nexport default function insertText(textarea: HTMLTextAreaElement, { text, selectionStart, selectionEnd }: SelectionRange) {\n  const originalSelectionStart = textarea.selectionStart;\n  const before = textarea.value.slice(0, originalSelectionStart);\n  const after = textarea.value.slice(textarea.selectionEnd);\n\n  if (canInsertText === null || canInsertText === true) {\n    textarea.contentEditable = 'true';\n    try {\n      canInsertText = document.execCommand('insertText', false, text);\n    } catch (error) {\n      canInsertText = false;\n    }\n    textarea.contentEditable = 'false';\n  }\n\n  if (canInsertText && !textarea.value.slice(0, textarea.selectionStart).endsWith(text)) {\n    canInsertText = false;\n  }\n\n  if (!canInsertText) {\n    textarea.value = before + text + after;\n    textarea.dispatchEvent(new CustomEvent('input', { bubbles: true, cancelable: true }));\n  }\n\n  if (selectionStart != null && selectionEnd != null) {\n    textarea.setSelectionRange(selectionStart, selectionEnd);\n  } else {\n    textarea.setSelectionRange(originalSelectionStart, textarea.selectionEnd);\n  }\n}\n","import Component, { type ComponentAttrs } from '../../common/Component';\nimport LoadingIndicator from '../../common/components/LoadingIndicator';\nimport ConfirmDocumentUnload from '../../common/components/ConfirmDocumentUnload';\nimport TextEditor from '../../common/components/TextEditor';\nimport listItems from '../../common/helpers/listItems';\nimport ItemList from '../../common/utils/ItemList';\nimport classList from '../../common/utils/classList';\nimport Avatar from '../../common/components/Avatar';\nimport ComposerState from '../states/ComposerState';\nimport type Mithril from 'mithril';\n\nexport interface IComposerBodyAttrs extends ComponentAttrs {\n  composer: ComposerState;\n  originalContent?: string;\n  submitLabel: string;\n  placeholder: string;\n  user: any;\n  confirmExit: string;\n  disabled: boolean;\n}\n\n/**\n * The `ComposerBody` component handles the body, or the content, of the\n * composer. Subclasses should implement the `onsubmit` method and override\n * `headerTimes`.\n */\nexport default abstract class ComposerBody<CustomAttrs extends IComposerBodyAttrs = IComposerBodyAttrs> extends Component<CustomAttrs> {\n  protected loading = false;\n  protected composer!: ComposerState;\n  protected jumpToPreview?: () => void;\n\n  static focusOnSelector: null | (() => string) = null;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.composer = this.attrs.composer;\n\n    // Let the composer state know to ask for confirmation under certain\n    // circumstances, if the body supports / requires it and has a corresponding\n    // confirmation question to ask.\n    if (this.attrs.confirmExit) {\n      this.composer.preventClosingWhen(() => this.hasChanges(), this.attrs.confirmExit);\n    }\n\n    this.composer.fields!.content(this.attrs.originalContent || '');\n  }\n\n  view() {\n    return (\n      <ConfirmDocumentUnload when={this.hasChanges.bind(this)}>\n        <div className={classList('ComposerBody', this.attrs.className)}>\n          <Avatar user={this.attrs.user} className=\"ComposerBody-avatar\" />\n          <div className=\"ComposerBody-content\">\n            <ul className=\"ComposerBody-header\">{listItems(this.headerItems().toArray())}</ul>\n            <div className=\"ComposerBody-editor\">\n              <TextEditor\n                submitLabel={this.attrs.submitLabel}\n                placeholder={this.attrs.placeholder}\n                disabled={this.loading || this.attrs.disabled}\n                composer={this.composer}\n                preview={this.jumpToPreview?.bind(this)}\n                onchange={this.composer.fields!.content}\n                onsubmit={this.onsubmit.bind(this)}\n                value={this.composer.fields!.content()}\n              />\n            </div>\n          </div>\n          <LoadingIndicator display=\"unset\" containerClassName={classList('ComposerBody-loading', this.loading && 'active')} size=\"large\" />\n        </div>\n      </ConfirmDocumentUnload>\n    );\n  }\n\n  /**\n   * Check if there is any unsaved data.\n   */\n  hasChanges(): boolean {\n    const content = this.composer.fields!.content();\n\n    return Boolean(content) && content !== this.attrs.originalContent;\n  }\n\n  /**\n   * Build an item list for the composer's header.\n   */\n  headerItems() {\n    return new ItemList<Mithril.Children>();\n  }\n\n  /**\n   * Handle the submit event of the text editor.\n   */\n  abstract onsubmit(): void;\n\n  /**\n   * Stop loading.\n   */\n  loaded() {\n    this.loading = false;\n    m.redraw();\n  }\n}\n"],"names":["Component","ConfirmDocumentUnload","_Component","apply","arguments","_inheritsLoose","_proto","prototype","handler","attrs","when","undefined","oncreate","vnode","call","boundHandler","bind","$","window","on","onremove","off","view","m","'['","children","default","app","ItemList","listItems","Button","BasicEditorDriver","Tooltip","LoadingIndicator","TextEditor","oninit","value","disabled","loading","_loaders","className","controlItems","toArray","toolbarItems","_this","_load","then","setTimeout","onbuild","composer","editor","buildEditor","onupdate","newDisabled","_this2","Promise","all","map","loader","redraw","buildEditorParams","_this3","classNames","placeholder","oninput","inputListeners","onsubmit","dom","items","add","icon","itemClassName","onclick","submitLabel","preview","text","translator","trans","onchange","getCaretCoordinates","insertText","params","el","document","createElement","build","join","callInputListeners","e","forEach","listener","onkeyup","addEventListener","keyHandlers","append","metaKey","ctrlKey","key","moveCursorTo","position","setSelectionRange","getSelectionRange","selectionStart","selectionEnd","getLastNChars","n","slice","Math","max","insertAtCursor","insertAt","pos","insertBetween","cursorPos","length","replaceBeforeCursor","start","end","focus","relCoords","top","scrollTop","left","destroy","remove","canInsertText","textarea","_ref","originalSelectionStart","before","after","contentEditable","execCommand","error","endsWith","dispatchEvent","CustomEvent","bubbles","cancelable","classList","Avatar","ComposerBody","_len","args","Array","_key","concat","jumpToPreview","confirmExit","preventClosingWhen","hasChanges","fields","content","originalContent","_this$jumpToPreview","user","headerItems","display","containerClassName","size","Boolean","loaded","focusOnSelector"],"sourceRoot":""}