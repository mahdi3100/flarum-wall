{"version":3,"file":"src_core_forum_components_LogInModal_tsx-_cb9c1.js","mappings":"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","sources":["webpack://@leo/flarum-wall/./src/core/forum/components/ForgotPasswordModal.tsx","webpack://@leo/flarum-wall/./src/core/forum/components/LogInModal.tsx"],"sourcesContent":["import app from '../../forum/app';\nimport FormModal, { IFormModalAttrs } from '../../common/components/FormModal';\nimport Button from '../../common/components/Button';\nimport extractText from '../../common/utils/extractText';\nimport Stream from '../../common/utils/Stream';\nimport Mithril from 'mithril';\nimport RequestError from '../../common/utils/RequestError';\nimport ItemList from '../../common/utils/ItemList';\nimport Form from '../../common/components/Form';\n\nexport interface IForgotPasswordModalAttrs extends IFormModalAttrs {\n  email?: string;\n}\n\n/**\n * The `ForgotPasswordModal` component displays a modal which allows the user to\n * enter their email address and request a link to reset their password.\n */\nexport default class ForgotPasswordModal<CustomAttrs extends IForgotPasswordModalAttrs = IForgotPasswordModalAttrs> extends FormModal<CustomAttrs> {\n  /**\n   * The value of the email input.\n   */\n  email!: Stream<string>;\n\n  success: boolean = false;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.email = Stream(this.attrs.email || '');\n  }\n\n  className() {\n    return 'ForgotPasswordModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('core.forum.forgot_password.title');\n  }\n\n  content() {\n    if (this.success) {\n      return (\n        <div className=\"Modal-body\">\n          <Form className=\"Form--centered\">\n            <p className=\"helpText\">{app.translator.trans('core.forum.forgot_password.email_sent_message')}</p>\n            <div className=\"Form-group Form-controls\">\n              <Button className=\"Button Button--primary Button--block\" onclick={this.hide.bind(this)}>\n                {app.translator.trans('core.forum.forgot_password.dismiss_button')}\n              </Button>\n            </div>\n          </Form>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"Modal-body\">\n        <Form className=\"Form--centered\" description={app.translator.trans('core.forum.forgot_password.text')}>\n          {this.fields().toArray()}\n        </Form>\n      </div>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    const emailLabel = extractText(app.translator.trans('core.forum.forgot_password.email_placeholder'));\n\n    items.add(\n      'email',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"email\"\n          type=\"email\"\n          placeholder={emailLabel}\n          aria-label={emailLabel}\n          bidi={this.email}\n          disabled={this.loading}\n        />\n      </div>,\n      50\n    );\n\n    items.add(\n      'submit',\n      <div className=\"Form-group Form-controls\">\n        <Button className=\"Button Button--primary Button--block\" type=\"submit\" loading={this.loading}>\n          {app.translator.trans('core.forum.forgot_password.submit_button')}\n        </Button>\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  onsubmit(e: SubmitEvent) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/forgot',\n        body: this.requestParams(),\n        errorHandler: this.onerror.bind(this),\n      })\n      .then(() => {\n        this.success = true;\n        this.alertAttrs = null;\n      })\n      .catch(() => {})\n      .then(this.loaded.bind(this));\n  }\n\n  requestParams(): Record<string, unknown> {\n    const data = {\n      email: this.email(),\n    };\n\n    return data;\n  }\n\n  onerror(error: RequestError) {\n    if (error.status === 404 && error.alert) {\n      error.alert.content = app.translator.trans('core.forum.forgot_password.not_found_message');\n    }\n\n    super.onerror(error);\n  }\n}\n","import app from '../../forum/app';\nimport FormModal, { IFormModalAttrs } from '../../common/components/FormModal';\nimport Button from '../../common/components/Button';\nimport LogInButtons from './LogInButtons';\nimport extractText from '../../common/utils/extractText';\nimport ItemList from '../../common/utils/ItemList';\nimport Stream from '../../common/utils/Stream';\nimport type Mithril from 'mithril';\nimport RequestError from '../../common/utils/RequestError';\nimport type { LoginParams } from '../../common/Session';\nimport ForgotPasswordModal from './ForgotPasswordModal';\n\nexport interface ILoginModalAttrs extends IFormModalAttrs {\n  identification?: string;\n  password?: string;\n  remember?: boolean;\n}\n\nexport default class LogInModal<CustomAttrs extends ILoginModalAttrs = ILoginModalAttrs> extends FormModal<CustomAttrs> {\n  /**\n   * The value of the identification input.\n   */\n  identification!: Stream<string>;\n  /**\n   * The value of the password input.\n   */\n  password!: Stream<string>;\n  /**\n   * The value of the remember me input.\n   */\n  remember!: Stream<boolean>;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.identification = Stream(this.attrs.identification || '');\n    this.password = Stream(this.attrs.password || '');\n    this.remember = Stream(!!this.attrs.remember);\n  }\n\n  className() {\n    return 'LogInModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('core.forum.log_in.title');\n  }\n\n  content() {\n    return [<div className=\"Modal-body\">{this.body()}</div>, <div className=\"Modal-footer\">{this.footer()}</div>];\n  }\n\n  body() {\n    return [<LogInButtons />, <div className=\"Form Form--centered\">{this.fields().toArray()}</div>];\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    const identificationLabel = extractText(app.translator.trans('core.forum.log_in.username_or_email_placeholder'));\n    const passwordLabel = extractText(app.translator.trans('core.forum.log_in.password_placeholder'));\n\n    items.add(\n      'identification',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"identification\"\n          type=\"text\"\n          placeholder={identificationLabel}\n          aria-label={identificationLabel}\n          bidi={this.identification}\n          disabled={this.loading}\n        />\n      </div>,\n      30\n    );\n\n    items.add(\n      'password',\n      <div className=\"Form-group\">\n        <input\n          className=\"FormControl\"\n          name=\"password\"\n          type=\"password\"\n          autocomplete=\"current-password\"\n          placeholder={passwordLabel}\n          aria-label={passwordLabel}\n          bidi={this.password}\n          disabled={this.loading}\n        />\n      </div>,\n      20\n    );\n\n    items.add(\n      'remember',\n      <div className=\"Form-group\">\n        <div>\n          <label className=\"checkbox\">\n            <input type=\"checkbox\" bidi={this.remember} disabled={this.loading} />\n            {app.translator.trans('core.forum.log_in.remember_me_label')}\n          </label>\n        </div>\n      </div>,\n      10\n    );\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        <Button className=\"Button Button--primary Button--block\" type=\"submit\" loading={this.loading}>\n          {app.translator.trans('core.forum.log_in.submit_button')}\n        </Button>\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  footer() {\n    return (\n      <>\n        <p className=\"LogInModal-forgotPassword\">\n          <Button className=\"Button Button--text Button--link\" onclick={this.forgotPassword.bind(this)}>\n            {app.translator.trans('core.forum.log_in.forgot_password_link')}\n          </Button>\n        </p>\n        {app.forum.attribute<boolean>('allowSignUp') && (\n          <p className=\"LogInModal-signUp\">\n            {app.translator.trans('core.forum.log_in.sign_up_text', {\n              a: <Button className=\"Button Button--text Button--link\" onclick={this.signUp.bind(this)} />,\n            })}\n          </p>\n        )}\n      </>\n    );\n  }\n\n  /**\n   * Open the forgot password modal, prefilling it with an email if the user has\n   * entered one.\n   */\n  forgotPassword() {\n    const email = this.identification();\n    const attrs = email.includes('@') ? { email } : undefined;\n\n    app.modal.show(ForgotPasswordModal, attrs);\n  }\n\n  /**\n   * Open the sign up modal, prefilling it with an email/username/password if\n   * the user has entered one.\n   */\n  signUp() {\n    const identification = this.identification();\n\n    const attrs = {\n      [identification.includes('@') ? 'email' : 'username']: identification,\n    };\n\n    app.modal.show(() => import('./SignUpModal'), attrs);\n  }\n\n  onready() {\n    this.$('[name=' + (this.identification() ? 'password' : 'identification') + ']').trigger('select');\n  }\n\n  onsubmit(e: SubmitEvent) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    app.session.login(this.loginParams(), { errorHandler: this.onerror.bind(this) }).then(() => window.location.reload(), this.loaded.bind(this));\n  }\n\n  loginParams(): LoginParams {\n    const data = {\n      identification: this.identification(),\n      password: this.password(),\n      remember: this.remember(),\n    };\n\n    return data;\n  }\n\n  onerror(error: RequestError) {\n    if (error.status === 401 && error.alert) {\n      error.alert.content = app.translator.trans('core.forum.log_in.invalid_login_message');\n      this.password('');\n    }\n\n    super.onerror(error);\n  }\n}\n"],"names":["app","FormModal","Button","extractText","Stream","ItemList","Form","ForgotPasswordModal","_FormModal","_this","_len","arguments","length","args","Array","_key","call","apply","concat","email","success","_inheritsLoose","_proto","prototype","oninit","vnode","attrs","className","title","translator","trans","content","m","onclick","hide","bind","description","fields","toArray","items","emailLabel","add","name","type","placeholder","bidi","disabled","loading","onsubmit","e","_this2","preventDefault","request","method","url","forum","attribute","body","requestParams","errorHandler","onerror","then","alertAttrs","loaded","data","error","status","alert","default","LogInButtons","LogInModal","identification","password","remember","footer","identificationLabel","passwordLabel","autocomplete","'['","forgotPassword","a","signUp","includes","undefined","modal","show","_attrs","onready","$","trigger","session","login","loginParams","window","location","reload"],"sourceRoot":""}