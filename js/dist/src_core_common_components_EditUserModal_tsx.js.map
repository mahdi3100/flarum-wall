{"version":3,"file":"src_core_common_components_EditUserModal_tsx.js","mappings":"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","sources":["webpack://@leo/profile-users-comments/./src/core/common/components/EditUserModal.tsx"],"sourcesContent":["import app from '../../common/app';\nimport FormModal, { IFormModalAttrs } from '../../common/components/FormModal';\nimport Button from './Button';\nimport GroupBadge from './GroupBadge';\nimport Group from '../models/Group';\nimport extractText from '../utils/extractText';\nimport ItemList from '../utils/ItemList';\nimport Stream from '../utils/Stream';\nimport type Mithril from 'mithril';\nimport type User from '../models/User';\nimport type { SaveAttributes, SaveRelationships } from '../Model';\nimport Form from './Form';\n\nexport interface IEditUserModalAttrs extends IFormModalAttrs {\n  user: User;\n}\n\nexport default class EditUserModal<CustomAttrs extends IEditUserModalAttrs = IEditUserModalAttrs> extends FormModal<CustomAttrs> {\n  protected username!: Stream<string>;\n  protected email!: Stream<string>;\n  protected isEmailConfirmed!: Stream<boolean>;\n  protected setPassword!: Stream<boolean>;\n  protected password!: Stream<string>;\n  protected groups: Record<string, Stream<boolean>> = {};\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    const user = this.attrs.user;\n\n    this.username = Stream(user.username() || '');\n    this.email = Stream(user.email() || '');\n    this.isEmailConfirmed = Stream(user.isEmailConfirmed() || false);\n    this.setPassword = Stream(false as boolean);\n    this.password = Stream(user.password() || '');\n\n    const userGroups = user.groups() || [];\n\n    app.store\n      .all<Group>('groups')\n      .filter((group) => ![Group.GUEST_ID, Group.MEMBER_ID].includes(group.id()!))\n      .forEach((group) => (this.groups[group.id()!] = Stream(userGroups.includes(group))));\n  }\n\n  className() {\n    return 'EditUserModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('core.lib.edit_user.title');\n  }\n\n  content() {\n    const fields = this.fields().toArray();\n    return (\n      <div className=\"Modal-body\">\n        {fields.length > 1 ? <Form>{this.fields().toArray()}</Form> : app.translator.trans('core.lib.edit_user.nothing_available')}\n      </div>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    if (this.attrs.user.canEditCredentials()) {\n      items.add(\n        'username',\n        <div className=\"Form-group\">\n          <label>{app.translator.trans('core.lib.edit_user.username_heading')}</label>\n          <input\n            className=\"FormControl\"\n            placeholder={extractText(app.translator.trans('core.lib.edit_user.username_label'))}\n            bidi={this.username}\n            disabled={this.nonAdminEditingAdmin()}\n          />\n        </div>,\n        40\n      );\n\n      if (app.session.user !== this.attrs.user) {\n        items.add(\n          'email',\n          <div className=\"Form-group\">\n            <label>{app.translator.trans('core.lib.edit_user.email_heading')}</label>\n            <input\n              className=\"FormControl\"\n              placeholder={extractText(app.translator.trans('core.lib.edit_user.email_label'))}\n              bidi={this.email}\n              disabled={this.nonAdminEditingAdmin()}\n            />\n            {!this.isEmailConfirmed() && this.userIsAdmin(app.session.user) && (\n              <Button className=\"Button Button--block\" loading={this.loading} onclick={this.activate.bind(this)}>\n                {app.translator.trans('core.lib.edit_user.activate_button')}\n              </Button>\n            )}\n          </div>,\n          30\n        );\n\n        items.add(\n          'password',\n          <div className=\"Form-group\">\n            <label>{app.translator.trans('core.lib.edit_user.password_heading')}</label>\n            <div>\n              <label className=\"checkbox\">\n                <input\n                  type=\"checkbox\"\n                  onchange={(e: KeyboardEvent) => {\n                    const target = e.target as HTMLInputElement;\n                    this.setPassword(target.checked);\n                    m.redraw.sync();\n                    if (target.checked) this.$('[name=password]').select();\n                    e.redraw = false;\n                  }}\n                  disabled={this.nonAdminEditingAdmin()}\n                />\n                {app.translator.trans('core.lib.edit_user.set_password_label')}\n              </label>\n            </div>\n            {this.setPassword() && (\n              <input\n                className=\"FormControl\"\n                type=\"password\"\n                name=\"password\"\n                placeholder={extractText(app.translator.trans('core.lib.edit_user.password_label'))}\n                bidi={this.password}\n                disabled={this.nonAdminEditingAdmin()}\n              />\n            )}\n          </div>,\n          20\n        );\n      }\n    }\n\n    if (this.attrs.user.canEditGroups()) {\n      items.add(\n        'groups',\n        <div className=\"Form-group EditUserModal-groups\">\n          <label>{app.translator.trans('core.lib.edit_user.groups_heading')}</label>\n          <div>\n            {Object.keys(this.groups)\n              .map((id) => app.store.getById<Group>('groups', id))\n              .filter(Boolean)\n              .map(\n                (group) =>\n                  // Necessary because filter(Boolean) doesn't narrow out falsy values.\n                  group && (\n                    <label className=\"checkbox\">\n                      <input\n                        type=\"checkbox\"\n                        bidi={this.groups[group.id()!]}\n                        disabled={\n                          group.id() === Group.ADMINISTRATOR_ID && (this.attrs.user === app.session.user || !this.userIsAdmin(app.session.user))\n                        }\n                      />\n                      <GroupBadge group={group} label={null} /> {group.nameSingular()}\n                    </label>\n                  )\n              )}\n          </div>\n        </div>,\n        10\n      );\n    }\n\n    items.add(\n      'submit',\n      <div className=\"Form-group Form-controls\">\n        <Button className=\"Button Button--primary\" type=\"submit\" loading={this.loading}>\n          {app.translator.trans('core.lib.edit_user.submit_button')}\n        </Button>\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  activate() {\n    this.loading = true;\n    const data = {\n      username: this.username(),\n      isEmailConfirmed: true,\n    };\n    this.attrs.user\n      .save(data, { errorHandler: this.onerror.bind(this) })\n      .then(() => {\n        this.isEmailConfirmed(true);\n        this.loading = false;\n        m.redraw();\n      })\n      .catch(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  data() {\n    const data: SaveAttributes = {};\n    const relationships: SaveRelationships = {};\n\n    if (this.attrs.user.canEditCredentials() && !this.nonAdminEditingAdmin()) {\n      data.username = this.username();\n\n      if (app.session.user !== this.attrs.user) {\n        data.email = this.email();\n      }\n\n      if (this.setPassword()) {\n        data.password = this.password();\n      }\n    }\n\n    if (this.attrs.user.canEditGroups()) {\n      relationships.groups = Object.keys(this.groups)\n        .filter((id) => this.groups[id]())\n        .map((id) => app.store.getById<Group>('groups', id))\n        .filter((g): g is Group => g instanceof Group);\n    }\n\n    data.relationships = relationships;\n\n    return data;\n  }\n\n  onsubmit(e: SubmitEvent) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    this.attrs.user\n      .save(this.data(), { errorHandler: this.onerror.bind(this) })\n      .then(this.hide.bind(this))\n      .catch(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  nonAdminEditingAdmin(): boolean {\n    return this.userIsAdmin(this.attrs.user) && !this.userIsAdmin(app.session.user);\n  }\n\n  /**\n   * @internal\n   */\n  protected userIsAdmin(user: User | null): boolean {\n    return !!(user?.groups() || []).some((g) => g?.id() === Group.ADMINISTRATOR_ID);\n  }\n}\n"],"names":["app","FormModal","Button","GroupBadge","Group","extractText","ItemList","Stream","Form","EditUserModal","_FormModal","_this","_len","arguments","length","args","Array","_key","call","apply","concat","username","email","isEmailConfirmed","setPassword","password","groups","_inheritsLoose","_proto","prototype","oninit","vnode","_this2","user","attrs","userGroups","store","all","filter","group","GUEST_ID","MEMBER_ID","includes","id","forEach","className","title","translator","trans","content","fields","toArray","m","_this3","items","canEditCredentials","add","placeholder","bidi","disabled","nonAdminEditingAdmin","session","userIsAdmin","loading","onclick","activate","bind","type","onchange","e","target","checked","redraw","sync","$","select","name","canEditGroups","Object","keys","map","getById","Boolean","ADMINISTRATOR_ID","label","nameSingular","_this4","data","save","errorHandler","onerror","then","_this5","relationships","g","onsubmit","_this6","preventDefault","hide","some","default"],"sourceRoot":""}